
/* Widget page: compact, home-screen friendly */
body.widget{
  min-height: 100vh;
  overflow-x: hidden;
}
.widget-shell{
  max-width: 560px;
  margin: 0 auto;
  padding: max(12px, env(safe-area-inset-top)) 12px max(16px, env(safe-area-inset-bottom));
  position: relative;
  z-index: 2;
}
.widget-bg{
  position: fixed; inset: 0;
  z-index: 0;
  pointer-events: none;
  opacity: .95;
}
.widget-bg::before{
  content:"";
  position:absolute; inset:-30%;
  background: radial-gradient(1200px 900px at 10% 10%, rgba(99,102,241,.28), rgba(11,16,32,0) 60%),
              radial-gradient(1000px 800px at 90% 10%, rgba(56,189,248,.22), rgba(11,16,32,0) 55%),
              radial-gradient(900px 700px at 50% 90%, rgba(236,72,153,.16), rgba(11,16,32,0) 60%);
  filter: blur(10px);
  transform: translate3d(var(--px, 0px), var(--py, 0px), 0);
}
.widget-bg::after{
  content:"";
  position:absolute; inset:0;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.12'/%3E%3C/svg%3E");
  mix-blend-mode: overlay;
  opacity: .25;
}
@media (prefers-reduced-motion: reduce){
  .widget-bg{ transition: none !important; }
  .widget-bg::before{ filter: none; }
}

.widget-head{
  display:flex; align-items:center; justify-content:space-between;
  gap: 12px;
  padding: 10px 10px 14px;
}
.widget-city{ font-size: 20px; font-weight: 700; letter-spacing: -0.02em;}
.widget-sub{ opacity: .8; font-size: 12px; margin-top: 2px;}
.widget-actions{ display:flex; gap: 8px; }

.widget-main{ display:flex; flex-direction:column; gap: 12px; }
.glass{
  border-radius: 18px;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.10);
  backdrop-filter: blur(12px);
  box-shadow: 0 10px 30px rgba(0,0,0,.22);
}
.widget-now{
  display:flex; align-items:stretch; justify-content:space-between;
  padding: 14px;
  overflow:hidden;
}
.now-temp{ font-size: 44px; font-weight: 800; letter-spacing:-0.03em; line-height:1; }
.now-desc{ font-size: 14px; opacity:.92; margin-top: 6px;}
.now-meta{ display:flex; gap: 10px; flex-wrap:wrap; margin-top: 10px; font-size:12px; opacity:.82;}
.unit{ font-size: 18px; opacity:.9; margin-left: 4px; }

.icon-wrap{ width: 74px; height: 74px; display:grid; place-items:center; }
.icon-wrap svg{ width: 74px; height:74px; }

.widget-chart{ padding: 12px; }
.chart-head{ display:flex; justify-content:space-between; align-items:baseline; gap: 10px; margin-bottom: 8px;}
.chart-title{ font-weight:700; letter-spacing:-.02em;}
.chart-hint{ font-size:12px; opacity:.7; }
.chart-wrap{ position:relative; }
#wSvg{ width: 100%; height: 140px; display:block; }
.chart-tip{
  position:absolute;
  padding: 8px 10px;
  border-radius: 14px;
  background: rgba(0,0,0,.55);
  border: 1px solid rgba(255,255,255,.12);
  backdrop-filter: blur(10px);
  font-size: 12px;
  pointer-events:none;
  transform: translate(-50%, -100%);
  white-space: nowrap;
}

.widget-hours{
  display:flex;
  gap: 10px;
  overflow:auto;
  padding: 10px;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
}
.widget-hours::-webkit-scrollbar{ height: 8px; }
.widget-hours::-webkit-scrollbar-thumb{ background: rgba(255,255,255,.12); border-radius: 999px; }
.hour-card{
  min-width: 92px;
  padding: 10px 10px 8px;
  border-radius: 16px;
  scroll-snap-align: start;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.045);
}
.hour-card.active{
  outline: 2px solid rgba(99,102,241,.75);
  background: rgba(99,102,241,.12);
}
.h-time{ font-size: 12px; opacity:.75; }
.h-ic{ width: 38px; height: 38px; margin: 8px 0 6px; }
.h-ic svg{ width: 38px; height: 38px; display:block; }
.h-temp{ font-size: 16px; font-weight: 700; letter-spacing:-.02em;}
.h-pr{ font-size: 11px; opacity:.75; margin-top: 4px; }

.widget-footer{ padding: 0 4px; display:flex; flex-direction:column; gap:6px; }
.tiny{ font-size: 11px; opacity:.72; }

/* Ambient weather FX (subtle) */
.widget-bg .fx{ position:absolute; inset:0; }

.widget-bg.bg-clear::before{ opacity: 1; }
.widget-bg.bg-cloud::before{ opacity: 1; filter: blur(12px) saturate(1.05); }
.widget-bg.bg-fog::before{ opacity: 1; }
.widget-bg.bg-rain::before{ opacity: 1; }
.widget-bg.bg-snow::before{ opacity: 1; }
.widget-bg.bg-storm::before{ opacity: 1; }

.widget-bg.bg-cloud::after{ opacity:.22; }

.widget-bg.bg-fog .fog{
  position:absolute; inset:-20%;
  background: radial-gradient(closest-side at 20% 40%, rgba(255,255,255,.10), rgba(255,255,255,0) 60%),
              radial-gradient(closest-side at 70% 60%, rgba(255,255,255,.08), rgba(255,255,255,0) 60%);
  filter: blur(18px);
  animation: fogMove 10s ease-in-out infinite alternate;
  opacity: .8;
}
@keyframes fogMove{
  from{ transform: translate3d(-2%, -1%,0); }
  to{ transform: translate3d(2%, 1%,0); }
}

.widget-bg.bg-rain .rain{
  position:absolute; inset:-20%;
  background-image: repeating-linear-gradient(110deg,
    rgba(255,255,255,.0) 0px,
    rgba(255,255,255,.0) 6px,
    rgba(255,255,255,.12) 7px,
    rgba(255,255,255,.0) 10px);
  background-size: 260px 260px;
  animation: rainFall 1.15s linear infinite;
  opacity: .55;
  filter: blur(.2px);
}
@keyframes rainFall{
  from{ transform: translate3d(-10%, -20%,0); }
  to{ transform: translate3d(10%, 20%,0); }
}

.widget-bg.bg-snow .snow{
  position:absolute; inset:0;
  background-image:
    radial-gradient(circle at 10% 20%, rgba(255,255,255,.55) 0 1.2px, rgba(255,255,255,0) 1.4px),
    radial-gradient(circle at 30% 70%, rgba(255,255,255,.45) 0 1.0px, rgba(255,255,255,0) 1.3px),
    radial-gradient(circle at 60% 30%, rgba(255,255,255,.50) 0 1.4px, rgba(255,255,255,0) 1.7px),
    radial-gradient(circle at 85% 60%, rgba(255,255,255,.42) 0 1.1px, rgba(255,255,255,0) 1.4px);
  background-size: 220px 220px, 260px 260px, 240px 240px, 280px 280px;
  animation: snowDrift 4.5s linear infinite;
  opacity: .55;
}
@keyframes snowDrift{
  from{ background-position: 0 -200px, 40px -220px, -30px -240px, 80px -260px; }
  to{ background-position: 0 260px, 40px 280px, -30px 300px, 80px 320px; }
}

.widget-bg.bg-storm .storm{
  position:absolute; inset:0;
  background: radial-gradient(600px 400px at 50% 30%, rgba(255,255,255,.10), rgba(255,255,255,0) 60%);
  opacity: .65;
}
.widget-bg.bg-storm .flash{
  position:absolute; inset:0;
  background: rgba(255,255,255,.0);
  animation: flash 6s ease-in-out infinite;
}
@keyframes flash{
  0%, 78%, 100% { background: rgba(255,255,255,0); }
  80% { background: rgba(255,255,255,.10); }
  81% { background: rgba(255,255,255,0); }
  84% { background: rgba(255,255,255,.06); }
  85% { background: rgba(255,255,255,0); }
}

@media (prefers-reduced-motion: reduce){
  .widget-bg .fog, .widget-bg .rain, .widget-bg .snow, .widget-bg .flash{ animation: none !important; }
}

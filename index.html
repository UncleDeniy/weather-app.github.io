<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#6366f1" />
  <meta name="color-scheme" content="light dark" />
  <title>WeatherVision — прогноз погоды</title>
  <meta name="description" content="Быстрый и удобный прогноз погоды: текущая, почасовая, на неделю, карта и избранные города." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <link rel="stylesheet" href="./assets/styles.css" />

  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="apple-touch-icon" href="./assets/icons/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />


  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><defs><linearGradient id='g' x1='0' x2='1'><stop stop-color='%236366f1'/><stop offset='1' stop-color='%238b5cf6'/></linearGradient></defs><path fill='url(%23g)' d='M24 46a14 14 0 1 1 3.2-27.6A16 16 0 0 1 55 28.6 10.5 10.5 0 0 1 52 49H24z'/><circle cx='22' cy='22' r='7' fill='%23fbbf24'/></svg>" />
</head>

<body>
  <div class="bg-layer" id="bgA" aria-hidden="true"></div>
  <div class="bg-layer bg-layer--alt" id="bgB" aria-hidden="true"></div>
<div aria-hidden="true" class="fx-layer" id="fxA"></div>
<div aria-hidden="true" class="fx-layer fx-layer--alt" id="fxB"></div>
  <a class="skip" href="#main">Перейти к контенту</a>

  <div class="app" id="app">
    <header class="topbar">
      <div class="brand">
        <div class="brand__mark" aria-hidden="true">WV</div>
        <div class="brand__text">
          <div class="brand__title">WeatherVision</div>
          <div class="brand__subtitle">Прогноз • Карта • Избранное</div>
        </div>
      </div>

      <form class="search" id="searchForm" role="search" aria-label="Поиск города">
        <label class="sr" for="cityInput">Город</label>
        <input id="cityInput" name="q" class="search__input" type="search" inputmode="search" autocomplete="off" placeholder="Введите город (например, Amsterdam)" />
        <div class="suggestions" id="suggestions" role="listbox" aria-label="Подсказки" hidden></div>
        <button class="btn btn--primary" type="submit" id="searchBtn">
          <span class="btn__icon" aria-hidden="true">⌕</span>
          <span class="btn__label">Найти</span>
        </button>
        <button class="btn btn--ghost" type="button" id="geoBtn" title="Определить местоположение" aria-label="Определить местоположение">
          <span aria-hidden="true">◎</span>
        </button>
      </form>

      <div class="actions">
        <div class="seg" role="group" aria-label="Единицы измерения">
          <button class="seg__btn" type="button" data-unit="metric" aria-pressed="true">°C</button>
          <button class="seg__btn" type="button" data-unit="imperial" aria-pressed="false">°F</button>
        </div>
        <button class="btn btn--ghost" type="button" id="themeBtn" aria-label="Переключить тему" title="Тема">
          <span aria-hidden="true">◐</span>
        </button>
        <button class="btn btn--ghost" type="button" id="settingsBtn" aria-label="Настройки" title="Настройки">
          <span aria-hidden="true">⚙</span>
        </button>
      </div>
    </header>

    <nav class="tabs" aria-label="Разделы">
      <button class="tab is-active" type="button" data-view="forecast" aria-pressed="true">Прогноз</button>
      <button class="tab" type="button" data-view="cities" aria-pressed="false">Города</button>
      <button class="tab" type="button" data-view="settings" aria-pressed="false">Настройки</button>
    </nav>

    <main id="main" class="layout" aria-live="polite">
      <section class="panel view" id="viewCities" hidden aria-label="Города">
        <div class="panel__head">
          <h2 class="h2">Города</h2>
          <div class="muted">Быстрый обзор избранных</div>
        </div>
        <div class="dash" id="dashboard"></div>
        <div class="muted" id="dashHint">Добавь города в избранное — они появятся здесь.</div>
      </section>

      <section class="panel view" id="viewSettings" hidden aria-label="Настройки">
        <div class="panel__head">
          <h2 class="h2">Настройки</h2>
          <div class="muted">Параметры и доступность</div>
        </div>
        <div class="settings">
          <div class="setting">
            <div>
              <div class="setting__k">Звук окружения</div>
              <div class="muted">Дождь/ветер/гроза — очень тихо (по умолчанию выкл.)</div>
            </div>
            <button class="toggle" id="soundToggle" type="button" aria-pressed="false">Выкл</button>
          </div>
          <div class="setting">
            <div>
              <div class="setting__k">Доступность</div>
              <div class="muted">Крупнее текст, выше контраст, меньше анимаций</div>
            </div>
            <button class="toggle" id="a11yToggle" type="button" aria-pressed="false">Выкл</button>
          </div>
          <div class="setting">
            <div>
              <div class="setting__k">Авто‑обновление</div>
              <div class="muted">Обновлять при возвращении в приложение или раз в 30 минут</div>
            </div>
            <button class="toggle" id="refreshToggle" type="button" aria-pressed="true">Вкл</button>
          </div>
          <div class="setting">
            <div>
              <div class="setting__k">Мини‑виджет</div>
              <div class="muted">Превью “как будто виджет” внутри приложения</div>
            </div>
            <div class="widget" id="widgetPreview" aria-label="Мини-виджет"></div>
          </div>
        </div>
      </section>

      <div class="offline" id="offlineScreen" hidden>
        <div class="offline__card">
          <div class="offline__title">Вы офлайн</div>
          <div class="muted" id="offlineText">Показываю последний сохранённый прогноз.</div>
          <button class="btn btn--primary" type="button" id="offlineTry">Попробовать обновить</button>
        </div>
      </div>

      <section class="panel view" id="viewForecast" aria-label="Прогноз">
      <section class="panel" aria-label="Текущая погода">
        <div class="panel__head">
          <div>
            <div class="kicker" id="placeKicker">—</div>
            <h1 class="h1" id="placeTitle">Загружаем…</h1>
            <p class="muted" id="placeMeta">—</p>
          </div>
          <button class="btn btn--ghost" type="button" id="favBtn" aria-label="Добавить в избранное" title="Избранное">
            <span id="favIcon" aria-hidden="true">☆</span>
          </button>
        </div>

        <div class="now">
          <div class="now__temp">
            <div class="temp" id="temp">—</div>
            <div class="temp__sub" id="summary">—</div>
            <div class="now__row">
              <div class="pill" id="confidence" title="Оценка надёжности прогноза">Надёжность: —</div>
              <button class="pill pill--btn" type="button" id="explainBtn">Почему так?</button>
            </div>
          </div>
          <div class="now__chipset">
            <div class="chip"><span class="chip__k">Ощущается</span><span class="chip__v" id="feels">—</span></div>
            <div class="chip"><span class="chip__k">Ветер</span><span class="chip__v" id="wind">—</span></div>
            <div class="chip"><span class="chip__k">Влажность</span><span class="chip__v" id="humidity">—</span></div>
          </div>
        </div>

        <div class="grid3">
          <div class="card">
            <div class="card__k">Давление</div>
            <div class="card__v" id="pressure">—</div>
          </div>
          <div class="card">
            <div class="card__k">УФ-индекс</div>
            <div class="card__v" id="uv">—</div>
          </div>
          <div class="card">
            <div class="card__k">Видимость</div>
            <div class="card__v" id="visibility">—</div>
          </div>
        </div>

	        <div class="grid4">
	          <div class="card">
	            <div class="card__k">Осадки (час)</div>
	            <div class="card__v" id="precipChance">—</div>
	          </div>
	          <div class="card">
	            <div class="card__k">Точка росы</div>
	            <div class="card__v" id="dewPoint">—</div>
	          </div>
	          <div class="card">
	            <div class="card__k">Восход</div>
	            <div class="card__v" id="sunrise">—</div>
	          </div>
	          <div class="card">
	            <div class="card__k">Закат</div>
	            <div class="card__v" id="sunset">—</div>
	          </div>
	        </div>

        <div class="notice" id="notice" hidden>
          <div class="notice__dot" aria-hidden="true"></div>
          <div class="notice__text" id="noticeText"></div>
        </div>

        <div class="timeline" id="timeline" aria-label="Таймлайн сегодня"></div>

        <div class="alerts" id="alerts" aria-label="Предупреждения" hidden>
          <div class="alerts__head">Предупреждения</div>
          <div class="alerts__list" id="alertsList"></div>
        </div>
      </section>

      <section class="panel panel--sticky" aria-label="Почасовой прогноз">
        <div class="panel__head panel__head--hourly">
          <div>
            <h2 class="h2">Почасовой</h2>
            <div class="muted" id="hourlyMeta">—</div>
          </div>
          <canvas class="hour-chart" id="hourChart" width="420" height="72" aria-hidden="true"></canvas>
      <div class="chart-tooltip" id="hourTooltip" role="status" aria-live="polite" hidden></div>
        </div>
        <div class="scroller" id="hourly" role="list" aria-label="Почасовой прогноз"></div>
      </section>

      <section class="panel" aria-label="Прогноз на неделю">
        <div class="panel__head">
          <h2 class="h2">7 дней</h2>
          <div class="muted" id="dailyMeta">—</div>
          <button class="btn btn--ghost" type="button" id="compareBtn" title="Сравнить дни" aria-label="Сравнить дни">⇄</button>
        </div>
        <div class="daily" id="daily" role="list" aria-label="Прогноз на 7 дней"></div>
      </section>

      <section class="panel" aria-label="Карта">
        <div class="panel__head">
          <h2 class="h2">Карта</h2>
          <div class="muted">Местоположение и метка</div>
        </div>
        <div class="map" id="map" role="application" aria-label="Карта"></div>
      </section>

      <aside class="panel panel--side" aria-label="Избранные города">
        <div class="panel__head">
          <h2 class="h2">Избранное</h2>
          <button class="btn btn--ghost" type="button" id="clearFavBtn" title="Очистить" aria-label="Очистить избранное">⟲</button>
        </div>
        <div class="favorites" id="favorites"></div>
        <div class="muted" id="favHint">Добавляй города звёздочкой — они появятся здесь.</div>
      </aside>
      </section>
    </main>

    <footer class="footer">
      <div class="muted">Данные: Open‑Meteo • Карта: Leaflet</div>
      <div class="muted">Работает на GitHub Pages • <span id="build">v1</span></div>
    </footer>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite" aria-atomic="true" hidden></div>

  <div class="modal" id="modal" hidden aria-hidden="true">
    <div class="modal__back" data-close="1" aria-hidden="true"></div>
    <div class="modal__card" role="dialog" aria-modal="true" aria-label="Диалог">
      <div class="modal__head">
        <div class="modal__title" id="modalTitle">—</div>
        <button class="btn btn--ghost" type="button" data-close="1" aria-label="Закрыть">✕</button>
      </div>
      <div class="modal__body" id="modalBody"></div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script type="module" src="./assets/app.js"></script>
</body>
</html>
